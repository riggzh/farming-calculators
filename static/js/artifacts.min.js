"use strict";function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}RegExp.escape=function(t){return t.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")},function(t){var e;(e="undefined"!=typeof jQuery&&jQuery?jQuery:{}).csv={defaults:{separator:",",delimiter:'"',headers:!0},hooks:{castToScalar:function(t,e){if(isNaN(t))return t;if(/\./.test(t))return parseFloat(t);var r=parseInt(t);return isNaN(r)?null:r}},parsers:{parse:function(e,r){function a(){if(c=0,u="",r.start&&r.state.rowNum<r.start)return n=[],r.state.rowNum++,void(r.state.colNum=1);if(r.onParseEntry===t)l.push(n);else{var e=r.onParseEntry(n,r.state);!1!==e&&l.push(e)}n=[],r.end&&r.state.rowNum>=r.end&&(m=!0),r.state.rowNum++,r.state.colNum=1}function o(){if(r.onParseValue===t)n.push(u);else{var e=r.onParseValue(u,r.state);!1!==e&&n.push(e)}u="",c=0,r.state.colNum++}var s=r.separator,i=r.delimiter;r.state.rowNum||(r.state.rowNum=1),r.state.colNum||(r.state.colNum=1);var l=[],n=[],c=0,u="",m=!1,f=RegExp.escape(s),d=RegExp.escape(i),p=/(D|S|\r\n|\n|\r|[^DS\r\n]+)/,h=p.source;return h=h.replace(/S/g,f),h=h.replace(/D/g,d),p=new RegExp(h,"gm"),e.replace(p,function(t){if(!m)switch(c){case 0:if(t===s){u+="",o();break}if(t===i){c=1;break}if(/^(\r\n|\n|\r)$/.test(t)){o(),a();break}u+=t,c=3;break;case 1:if(t===i){c=2;break}u+=t,c=1;break;case 2:if(t===i){u+=t,c=1;break}if(t===s){o();break}if(/^(\r\n|\n|\r)$/.test(t)){o(),a();break}throw new Error("CSVDataError: Illegal State [Row:"+r.state.rowNum+"][Col:"+r.state.colNum+"]");case 3:if(t===s){o();break}if(/^(\r\n|\n|\r)$/.test(t)){o(),a();break}if(t===i)throw new Error("CSVDataError: Illegal Quote [Row:"+r.state.rowNum+"][Col:"+r.state.colNum+"]");throw new Error("CSVDataError: Illegal Data [Row:"+r.state.rowNum+"][Col:"+r.state.colNum+"]");default:throw new Error("CSVDataError: Unknown State [Row:"+r.state.rowNum+"][Col:"+r.state.colNum+"]")}}),0!==n.length&&(o(),a()),l},splitLines:function(e,r){function a(){if(l=0,r.start&&r.state.rowNum<r.start)return n="",void r.state.rowNum++;if(r.onParseEntry===t)i.push(n);else{var e=r.onParseEntry(n,r.state);!1!==e&&i.push(e)}n="",r.end&&r.state.rowNum>=r.end&&(c=!0),r.state.rowNum++}var o=r.separator,s=r.delimiter;r.state.rowNum||(r.state.rowNum=1);var i=[],l=0,n="",c=!1,u=RegExp.escape(o),m=RegExp.escape(s),f=/(D|S|\n|\r|[^DS\r\n]+)/,d=f.source;return d=d.replace(/S/g,u),d=d.replace(/D/g,m),f=new RegExp(d,"gm"),e.replace(f,function(t){if(!c)switch(l){case 0:if(t===o){n+=t,l=0;break}if(t===s){n+=t,l=1;break}if("\n"===t){a();break}if(/^\r$/.test(t))break;n+=t,l=3;break;case 1:if(t===s){n+=t,l=2;break}n+=t,l=1;break;case 2:var e=n.substr(n.length-1);if(t===s&&e===s){n+=t,l=1;break}if(t===o){n+=t,l=0;break}if("\n"===t){a();break}if("\r"===t)break;throw new Error("CSVDataError: Illegal state [Row:"+r.state.rowNum+"]");case 3:if(t===o){n+=t,l=0;break}if("\n"===t){a();break}if("\r"===t)break;if(t===s)throw new Error("CSVDataError: Illegal quote [Row:"+r.state.rowNum+"]");throw new Error("CSVDataError: Illegal state [Row:"+r.state.rowNum+"]");default:throw new Error("CSVDataError: Unknown state [Row:"+r.state.rowNum+"]")}}),""!==n&&a(),i},parseEntry:function(e,r){function a(){if(r.onParseValue===t)i.push(n);else{var e=r.onParseValue(n,r.state);!1!==e&&i.push(e)}n="",l=0,r.state.colNum++}var o=r.separator,s=r.delimiter;r.state.rowNum||(r.state.rowNum=1),r.state.colNum||(r.state.colNum=1);var i=[],l=0,n="";if(!r.match){var c=RegExp.escape(o),u=RegExp.escape(s),m=/(D|S|\n|\r|[^DS\r\n]+)/.source;m=(m=m.replace(/S/g,c)).replace(/D/g,u),r.match=new RegExp(m,"gm")}return e.replace(r.match,function(t){switch(l){case 0:if(t===o){n+="",a();break}if(t===s){l=1;break}if("\n"===t||"\r"===t)break;n+=t,l=3;break;case 1:if(t===s){l=2;break}n+=t,l=1;break;case 2:if(t===s){n+=t,l=1;break}if(t===o){a();break}if("\n"===t||"\r"===t)break;throw new Error("CSVDataError: Illegal State [Row:"+r.state.rowNum+"][Col:"+r.state.colNum+"]");case 3:if(t===o){a();break}if("\n"===t||"\r"===t)break;if(t===s)throw new Error("CSVDataError: Illegal Quote [Row:"+r.state.rowNum+"][Col:"+r.state.colNum+"]");throw new Error("CSVDataError: Illegal Data [Row:"+r.state.rowNum+"][Col:"+r.state.colNum+"]");default:throw new Error("CSVDataError: Unknown State [Row:"+r.state.rowNum+"][Col:"+r.state.colNum+"]")}}),a(),i}},helpers:{collectPropertyNames:function(t){var e,r,a=[];for(e in t)for(r in t[e])t[e].hasOwnProperty(r)&&a.indexOf(r)<0&&"function"!=typeof t[e][r]&&a.push(r);return a}},toArray:function(r,a,o){a=a!==t?a:{};var s={};s.callback=o!==t&&"function"==typeof o&&o,s.separator="separator"in a?a.separator:e.csv.defaults.separator,s.delimiter="delimiter"in a?a.delimiter:e.csv.defaults.delimiter;var i=a.state!==t?a.state:{};a={delimiter:s.delimiter,separator:s.separator,onParseEntry:a.onParseEntry,onParseValue:a.onParseValue,state:i};var l=e.csv.parsers.parseEntry(r,a);if(!s.callback)return l;s.callback("",l)},toArrays:function(r,a,o){a=a!==t?a:{};var s={};s.callback=o!==t&&"function"==typeof o&&o,s.separator="separator"in a?a.separator:e.csv.defaults.separator,s.delimiter="delimiter"in a?a.delimiter:e.csv.defaults.delimiter;var i=[];if((a={delimiter:s.delimiter,separator:s.separator,onPreParse:a.onPreParse,onParseEntry:a.onParseEntry,onParseValue:a.onParseValue,onPostParse:a.onPostParse,start:a.start,end:a.end,state:{rowNum:1,colNum:1}}).onPreParse!==t&&a.onPreParse(r,a.state),i=e.csv.parsers.parse(r,a),a.onPostParse!==t&&a.onPostParse(i,a.state),!s.callback)return i;s.callback("",i)},toObjects:function(r,a,o){a=a!==t?a:{};var s={};s.callback=o!==t&&"function"==typeof o&&o,s.separator="separator"in a?a.separator:e.csv.defaults.separator,s.delimiter="delimiter"in a?a.delimiter:e.csv.defaults.delimiter,s.headers="headers"in a?a.headers:e.csv.defaults.headers,a.start="start"in a?a.start:1,s.headers&&a.start++,a.end&&s.headers&&a.end++;var i=[],l=[];a={delimiter:s.delimiter,separator:s.separator,onPreParse:a.onPreParse,onParseEntry:a.onParseEntry,onParseValue:a.onParseValue,onPostParse:a.onPostParse,start:a.start,end:a.end,state:{rowNum:1,colNum:1},match:!1,transform:a.transform};var n={delimiter:s.delimiter,separator:s.separator,start:1,end:1,state:{rowNum:1,colNum:1}};a.onPreParse!==t&&a.onPreParse(r,a.state);var c=e.csv.parsers.splitLines(r,n),u=e.csv.toArray(c[0],a);i=e.csv.parsers.splitLines(r,a),a.state.colNum=1,a.state.rowNum=u?2:1;for(var m=0,f=i.length;m<f;m++){for(var d=e.csv.toArray(i[m],a),p={},h=0;h<u.length;h++)p[u[h]]=d[h];a.transform!==t?l.push(a.transform.call(t,p)):l.push(p),a.state.rowNum++}if(a.onPostParse!==t&&a.onPostParse(l,a.state),!s.callback)return l;s.callback("",l)},fromArrays:function(r,a,o){a=a!==t?a:{};var s={};s.callback=o!==t&&"function"==typeof o&&o,s.separator="separator"in a?a.separator:e.csv.defaults.separator,s.delimiter="delimiter"in a?a.delimiter:e.csv.defaults.delimiter;var i,l,n,c,u="";for(n=0;n<r.length;n++){for(i=r[n],l=[],c=0;c<i.length;c++){var m=i[c]===t||null===i[c]?"":i[c].toString();m.indexOf(s.delimiter)>-1&&(m=m.replace(s.delimiter,s.delimiter+s.delimiter));var f="\n|\r|S|D";f=(f=f.replace("S",s.separator)).replace("D",s.delimiter),m.search(f)>-1&&(m=s.delimiter+m+s.delimiter),l.push(m)}u+=l.join(s.separator)+"\r\n"}if(!s.callback)return u;s.callback("",u)},fromObjects:function(r,a,o){a=a!==t?a:{};var s={};if(s.callback=o!==t&&"function"==typeof o&&o,s.separator="separator"in a?a.separator:e.csv.defaults.separator,s.delimiter="delimiter"in a?a.delimiter:e.csv.defaults.delimiter,s.headers="headers"in a?a.headers:e.csv.defaults.headers,s.sortOrder="sortOrder"in a?a.sortOrder:"declare",s.manualOrder="manualOrder"in a?a.manualOrder:[],s.transform=a.transform,"string"==typeof s.manualOrder&&(s.manualOrder=e.csv.toArray(s.manualOrder,s)),s.transform!==t){var i=r;r=[];var l;for(l=0;l<i.length;l++)r.push(s.transform.call(t,i[l]))}var n=e.csv.helpers.collectPropertyNames(r);if("alpha"===s.sortOrder&&n.sort(),s.manualOrder.length>0){var c=[].concat(s.manualOrder);for(m=0;m<n.length;m++)c.indexOf(n[m])<0&&c.push(n[m]);n=c}var u,m,f,d,p=[];for(s.headers&&p.push(n),u=0;u<r.length;u++){for(f=[],m=0;m<n.length;m++)(d=n[m])in r[u]&&"function"!=typeof r[u][d]?f.push(r[u][d]):f.push("");p.push(f)}return e.csv.fromArrays(p,a,s.callback)}},e.csvEntry2Array=e.csv.toArray,e.csv2Array=e.csv.toArrays,e.csv2Dictionary=e.csv.toObjects,"undefined"!=typeof module&&module.exports&&(module.exports=e.csv)}.call(void 0);var _createClass=function(){function t(t,e){for(var r=0;r<e.length;r++){var a=e[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(e,r,a){return r&&t(e.prototype,r),a&&t(e,a),e}}(),artifactsPrestigeCalc=function(t){function e(t,r){_classCallCheck(this,e);var a=_possibleConstructorReturn(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return a.domEl.artType=a.getEl("art-type"),a.domEl.artifact=a.getEl("artifact"),a.domEl.artDesc=a.getEl("art-desc"),a.domEl.artFrom=a.getEl("art-from"),a.domEl.artFromUnit=a.getEl("art-from-unit"),a.domEl.artTo=a.getEl("art-to"),a.domEl.artToUnit=a.getEl("art-to-unit"),a.domEl.calcBtn=a.getEl("btn-calc"),a.domEl.prestigeResult=a.getEl("prestige-result"),a.domEl.totalRelics=a.getEl("total-relics"),a.domEl.oldBonus=a.getEl("old-bonus"),a.domEl.newBonus=a.getEl("new-bonus"),a.domEl.diffBonus=a.getEl("diff-bonus"),a.domEl.bonusIncrease=a.getEl("bonus-increase"),a.artType=void 0,a.artifact=void 0,a.artFrom=void 0,a.artFromUnit=void 0,a.artFromLvl=void 0,a.artTo=void 0,a.artToUnit=void 0,a.artTolvl=void 0,a.formulas.setArtFormulas(t),a.artInfos=r,a.setArtifactsPrestigeGlobalValues(),a.initInputs(),a.populateArtifactsPrestigeValues(),a.calcArtPrestigeAmount(),a.bindEvents(),a}return _inherits(e,farmingCalc),_createClass(e,[{key:"setArtifactsPrestigeGlobalValues",value:function(){this.setGlobalValues(),this.artType=localStorage.getItem("artType")?localStorage.getItem("artType"):"",this.artifact=localStorage.getItem("artifact")?localStorage.getItem("artifact"):"",this.artFrom=localStorage.getItem("artFrom")?localStorage.getItem("artFrom"):"",this.artFromUnit=localStorage.getItem("artFromUnit")?localStorage.getItem("artFromUnit"):"-",this.artTo=localStorage.getItem("artTo")?localStorage.getItem("artTo"):"",this.artToUnit=localStorage.getItem("artToUnit")?localStorage.getItem("artToUnit"):"-"}},{key:"populateArtifactsPrestigeValues",value:function(){this.populateValues(),localStorage.setItem("artType",this.artType),localStorage.setItem("artifact",this.artifact),localStorage.setItem("artFrom",this.artFrom),localStorage.setItem("artFromUnit",this.artFromUnit),localStorage.setItem("artTo",this.artTo),localStorage.setItem("artToUnit",this.artToUnit),this.domEl.artFrom.value=this.artFrom,this.domEl.artFromUnit.value=this.artFromUnit,this.domEl.artTo.value=this.artTo,this.domEl.artToUnit.value=this.artToUnit;for(var t=0;t<this.domEl.artType.options.length;t++)this.domEl.artType.options[t].value==this.artType&&(this.domEl.artType.options[t].selected=!0);for(var e=0;e<this.domEl.artifact.options.length;e++)this.domEl.artifact.options[e].value==this.artifact&&(this.domEl.artifact.options[e].selected=!0);this.artFromLvl="-"!=this.artFromUnit?this.formulas.convertNumber(this.artFromUnit)*this.artFrom:parseInt(this.artFrom),this.artToLvl="-"!=this.artToUnit?this.formulas.convertNumber(this.artToUnit)*this.artTo:parseInt(this.artTo)}},{key:"updateArtifactsPrestigeValues",value:function(){this.updateValues(),this.artType=this.domEl.artType.options[this.domEl.artType.selectedIndex].value,this.artifact=this.domEl.artifact.options[this.domEl.artifact.selectedIndex].value,this.artFrom=parseFloat(this.domEl.artFrom.value),this.artFromUnit=this.domEl.artFromUnit.options[this.domEl.artFromUnit.selectedIndex].value,this.artTo=parseFloat(this.domEl.artTo.value),this.artToUnit=this.domEl.artToUnit.options[this.domEl.artToUnit.selectedIndex].value,this.populateArtifactsPrestigeValues()}},{key:"initInputs",value:function(){""==this.artType||""==this.artifact?(this.domEl.artFrom.setAttribute("disabled","disabled"),this.domEl.artTo.setAttribute("disabled","disabled"),this.domEl.artFrom.value=0,this.domEl.artTo.value=0):(this.domEl.artFrom.removeAttribute("disabled"),this.domEl.artTo.removeAttribute("disabled")),""==this.artType?this.domEl.artifact.setAttribute("disabled","disabled"):this.generateArtDropdown(this.artType),""!=this.artifact&&this.setArtDescription(this.artifact)}},{key:"bindEvents",value:function(){var t=this;this.domEl.artType.onchange=function(){var e=this.value;t.generateArtDropdown(e)},this.domEl.artifact.onchange=function(){var e=this.value;t.setArtDescription(e),t.domEl.artFrom.removeAttribute("disabled"),t.domEl.artTo.removeAttribute("disabled")},this.domEl.calcBtn.onclick=function(){t.updateArtifactsPrestigeValues(),t.calcArtPrestigeAmount()}}},{key:"generateArtDropdown",value:function(t){var e=this.domEl.artifact;e.length=1;for(var r=this.artInfos.filter(function(e){return e.type==t}),a=0;a<r.length;a++)e.options[e.options.length]=new Option(r[a].name+" ("+r[a].tier+")",r[a].id);e.removeAttribute("disabled")}},{key:"setArtDescription",value:function(t){if(""!=t){var e=this.artInfos.filter(function(e){return e.id==t});e=e[0],this.domEl.artDesc.innerHTML="("+e.effect+")"}else this.domEl.artDesc.innerHTML=""}},{key:"calcArtPrestigeAmount",value:function(){var t=this.artFromLvl,e=this.artToLvl,r=this.domEl.artifact.options[this.domEl.artifact.selectedIndex].value,a=0,o=0,s=0,i=0,l=this.relicsOwned>0?this.relicsOwned:0,n=0,c=0,u=0,m=0;if(this.stage>=100&&e>t&&""!=r){for(a=this.formulas.calcBaseRelics(this.stage),o=this.bosLvl>0?this.formulas.calcPrestigeRelics(a,this.bosLvl,this.sets):a,s=this.formulas.calcArtTotalCost(r,t,e);s>l&&i<1e6;)i++,l+=o;1e6==i&&(i="1M+"),n=this.formulas.calcArtEffectBonus(r,t),c=this.formulas.calcArtEffectBonus(r,e),m=parseFloat(parseFloat(c)-parseFloat(n)).toFixed(2),u=parseFloat(parseFloat(c)/parseFloat(n)).toFixed(2),this.domEl.prestigeResult.innerHTML=i,this.domEl.totalRelics.innerHTML=this.formulas.numFormat(s),this.domEl.oldBonus.innerHTML="x"+this.formulas.numFormat(n),this.domEl.newBonus.innerHTML="x"+this.formulas.numFormat(c),this.domEl.diffBonus.innerHTML="x"+this.formulas.numFormat(m),this.domEl.bonusIncrease.innerHTML="x"+u}}}]),e}(),artifactInfos=[],artifactFormulas=[];$(document).ready(function(){$.ajax({url:"data/artifacts.csv",dataType:"text",async:!1,success:function(t){var e,r,a=$.csv.toArrays(t);a.splice(0,2),$.each(a,function(t,a){e={id:a[0],tier:a[1],name:a[2],effect:a[3],type:a[4]},r={id:a[0],effectPerLevel:a[5],growthMax:a[6],growthRate:a[7],growthExpo:a[8],damageBonus:a[9],costCoef:a[10],costExpo:a[11]},artifactInfos.push(e),artifactFormulas.push(r)})},complete:function(){new artifactsPrestigeCalc(artifactFormulas,artifactInfos)}})});